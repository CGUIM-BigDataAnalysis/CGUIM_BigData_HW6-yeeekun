AirPollution.201610[,i] <- as.numeric(AirPollution.201610[,i])
}
}
AirPollution.201610$Average<- round(rowMeans(AirPollution.201610[, 4:27],na.rm = TRUE),2)
AirPollution.201610 <- AirPollution.201610[order(AirPollution.201610$Item, -AirPollution.201610$Average),]
#11月
AirPollution.201611 <- rbind(
Banqiao[grepl("2016/11",Banqiao$Date),],
Linkou[grepl("2016/11",Linkou$Date),],
Sanchong[grepl("2016/11",Sanchong$Date),],
Tucheng[grepl("2016/11",Tucheng$Date),],
WanLi[grepl("2016/11",WanLi$Date),],
Xinzhuang[grepl("2016/11",Xinzhuang$Date),],
Xizhi[grepl("2016/11",Xizhi$Date),])
AirPollution.201611 <- as.data.frame(AirPollution.201611)
for (i in 4:ncol(AirPollution.201611)) {
if (!all(AirPollution.201611[,i] %in% c(" ","x","*","#"))) {
AirPollution.201611[,i] <- as.numeric(AirPollution.201611[,i])
}
}
AirPollution.201611$Average<- round(rowMeans(AirPollution.201611[, 4:27],na.rm = TRUE),2)
AirPollution.201611 <- AirPollution.201611[order(AirPollution.201611$Item, -AirPollution.201611$Average),]
#12月
AirPollution.201612 <- rbind(
Banqiao[grepl("2016/12",Banqiao$Date),],
Linkou[grepl("2016/12",Linkou$Date),],
Sanchong[grepl("2016/12",Sanchong$Date),],
Tucheng[grepl("2016/12",Tucheng$Date),],
WanLi[grepl("2016/12",WanLi$Date),],
Xinzhuang[grepl("2016/12",Xinzhuang$Date),],
Xizhi[grepl("2016/12",Xizhi$Date),])
AirPollution.201612 <- as.data.frame(AirPollution.201612)
for (i in 4:ncol(AirPollution.201612)) {
if (!all(AirPollution.201612[,i] %in% c(" ","x","*","#"))) {
AirPollution.201612[,i] <- as.numeric(AirPollution.201612[,i])
}
}
AirPollution.201612$Average<- round(rowMeans(AirPollution.201612[, 4:27],na.rm = TRUE),2)
AirPollution.201612 <- AirPollution.201612[order(AirPollution.201612$Item, -AirPollution.201612$Average),]
##8+9+10+11+12月
Air_Tidy<-rbind(
AirPollution.201608[,-4:-27] %>% group_by(Station,Item) %>%
summarise(
Month= 8,
Mean = mean(Average,na.rm = T)),
AirPollution.201609[,-4:-27] %>% group_by(Station,Item) %>%
summarise(
Month= 9,
Mean = mean(Average,na.rm = T)),
AirPollution.201610[,-4:-27] %>% group_by(Station,Item) %>%
summarise(
Month= 10,
Mean = mean(Average,na.rm = T)),
AirPollution.201611[,-4:-27] %>% group_by(Station,Item) %>%
summarise(
Month= 11,
Mean = mean(Average,na.rm = T)),
AirPollution.201612[,-4:-27] %>% group_by(Station,Item) %>%
summarise(
Month= 12,
Mean = mean(Average,na.rm = T))
)
Air_Tidy
factory_operate <- NewTaipeiFactoryLocation[grepl("生產中",NewTaipeiFactoryLocation$STATUS),]
factory_operate$Area <- substr(factory_operate$FACT_ADDR,4,6)
library(dplyr)
factory_Area_Qunality <- group_by(factory_operate,Area)%>%summarise(nQuantity=n_distinct(REGI_ID))
factory_Area_Qunality <- arrange(factory_Area_Qunality,desc(nQuantity))
library(reshape2)
library(tidyr)
library(ggplot2)
Air_Tidy.s <- spread(Air_Tidy, Item, Mean)
Air_Tidy.m <- melt(Air_Tidy, id.vars = c("Station","Month","Item"))
View(Air_Tidy.s)
cor(Air_Tidy.s$PM10,Air_Tidy.s$PM2.5)
ggplot(data=Air_Tidy.s) +
# 散布圖對應的函式是geom_point()
geom_point(aes(x=PM2.5,  # 用aes()，描繪散布圖內的各種屬性
y=PM10,
main="Scatter Plot of PM10-PM2.5",
color=Month
)
) +
# 用geom_smooth()加上趨勢線
geom_smooth(aes(x=PM2.5,
y=PM10)) +
# 用labs()，進行文字上的標註(Annotation)
labs(title="Scatter of PM10-PM2.5",
x="PM2.5",
y="PM10") + theme_bw()
qplot(Station , data = Air_Tidy.s, geom = "bar", weight = PM2.5/3) +
ylab("PM2.5") + geom_bar(stat = 'count', fill = 'steelblue', colour = 'blue')
qplot(Station , data = Air_Tidy.s, geom = "bar", weight = PM2.5/5) +
ylab("PM2.5") + geom_bar(stat = 'count', fill = 'steelblue', colour = 'blue')
qplot(Station , data = Air_Tidy.s, geom = "bar", weight = PM2.5/5) +
ylab("PM2.5") + geom_bar(stat = 'count', fill = 'steelblue', colour = 'blue')+ theme_bw()
ggplot(data=Air_Tidy.s) +
# 散布圖對應的函式是geom_point()
geom_point(aes(x=PM2.5,  # 用aes()，描繪散布圖內的各種屬性
y=PM10,
main="Scatter Plot of PM10-PM2.5",
color=Month
)
) +
# 用geom_smooth()加上趨勢線
geom_smooth(aes(x=PM2.5,
y=PM10)) +
# 用labs()，進行文字上的標註(Annotation)
labs(title="Scatter of PM10-PM2.5",
x="PM2.5",
y="PM10") + theme_bw()
low = "yellow",high = "red")+
ggplot(data=Air_Tidy.s) +
# 散布圖對應的函式是geom_point()
geom_point(aes(x=PM2.5,  # 用aes()，描繪散布圖內的各種屬性
y=PM10,
main="Scatter Plot of PM10-PM2.5",
color=Month
)
) +
# 用geom_smooth()加上趨勢線
geom_smooth(aes(x=PM2.5,
y=PM10)) +
scale_color_continuous(
low = "yellow",high = "red")+
guides(size=FALSE)+
# 用labs()，進行文字上的標註(Annotation)
labs(title="Scatter of PM10-PM2.5",
x="PM2.5",
y="PM10") + theme_bw()
low = "blue",high = "black")+
ggplot(data=Air_Tidy.s) +
# 散布圖對應的函式是geom_point()
geom_point(aes(x=PM2.5,  # 用aes()，描繪散布圖內的各種屬性
y=PM10,
main="Scatter Plot of PM10-PM2.5",
color=Month
)
) +
# 用geom_smooth()加上趨勢線
geom_smooth(aes(x=PM2.5,
y=PM10)) +
scale_color_continuous(
low = "blue",high = "black")+
guides(size=FALSE)+
# 用labs()，進行文字上的標註(Annotation)
labs(title="Scatter of PM10-PM2.5",
x="PM2.5",
y="PM10") + theme_bw()
low = "blue",high = "darkblue")+
ggplot(data=Air_Tidy.s) +
# 散布圖對應的函式是geom_point()
geom_point(aes(x=PM2.5,  # 用aes()，描繪散布圖內的各種屬性
y=PM10,
main="Scatter Plot of PM10-PM2.5",
color=Month
)
) +
# 用geom_smooth()加上趨勢線
geom_smooth(aes(x=PM2.5,
y=PM10)) +
scale_color_continuous(
low = "blue",high = "darkblue")+
guides(size=FALSE)+
# 用labs()，進行文字上的標註(Annotation)
labs(title="Scatter of PM10-PM2.5",
x="PM2.5",
y="PM10") + theme_bw()
ggplot(data=Air_Tidy.s) +
# 散布圖對應的函式是geom_point()
geom_point(aes(x=PM2.5,  # 用aes()，描繪散布圖內的各種屬性
y=PM10,
main="Scatter Plot of PM10-PM2.5",
color=Month
)
) +
# 用geom_smooth()加上趨勢線
geom_smooth(aes(x=PM2.5,
y=PM10)) +
scale_color_continuous(
low = "lightblue",high = "darkblue")+
guides(size=FALSE)+
# 用labs()，進行文字上的標註(Annotation)
labs(title="Scatter of PM10-PM2.5",
x="PM2.5",
y="PM10") + theme_bw()
ggplot(data=Air_Tidy.s) +
# 散布圖對應的函式是geom_point()
geom_point(aes(x=PM2.5,  # 用aes()，描繪散布圖內的各種屬性
y=PM10,
main="Scatter Plot of PM10-PM2.5",
color=Month
)
) +
# 用geom_smooth()加上趨勢線
geom_smooth(aes(x=PM2.5,
y=PM10)) +
scale_color_continuous(
low = "steelblue",high = "darkblue")+
guides(size=FALSE)+
# 用labs()，進行文字上的標註(Annotation)
labs(title="Scatter of PM10-PM2.5",
x="PM2.5",
y="PM10") + theme_bw()
ggplot(data=Air_Tidy.s) +
# 散布圖對應的函式是geom_point()
geom_point(aes(x=PM2.5,  # 用aes()，描繪散布圖內的各種屬性
y=PM10,
main="Scatter Plot of PM10-PM2.5",
color=Month
)
) +
# 用geom_smooth()加上趨勢線
geom_smooth(aes(x=PM2.5,
y=PM10)) +
scale_color_continuous(
low = "gray",high = "darkblue")+
guides(size=FALSE)+
# 用labs()，進行文字上的標註(Annotation)
labs(title="Scatter of PM10-PM2.5",
x="PM2.5",
y="PM10") + theme_bw()
low = "lightblue",high = "darkblue")+
ggplot(data=Air_Tidy.s) +
# 散布圖對應的函式是geom_point()
geom_point(aes(x=PM2.5,  # 用aes()，描繪散布圖內的各種屬性
y=PM10,
main="Scatter Plot of PM10-PM2.5",
color=Month
)
) +
# 用geom_smooth()加上趨勢線
geom_smooth(aes(x=PM2.5,
y=PM10)) +
scale_color_continuous(low = "lightblue",high = "darkblue")+
guides(size=FALSE)+
# 用labs()，進行文字上的標註(Annotation)
labs(title="Scatter of PM10-PM2.5",
x="PM2.5",
y="PM10") + theme_bw()
ggplot(data=Air_Tidy.s) +
# 散布圖對應的函式是geom_point()
geom_point(aes(x=PM2.5,  # 用aes()，描繪散布圖內的各種屬性
y=PM10,
main="Scatter Plot of PM10-PM2.5",
color=Month
size=5
ggplot(data=Air_Tidy.s) +
# 散布圖對應的函式是geom_point()
geom_point(aes(x=PM2.5,  # 用aes()，描繪散布圖內的各種屬性
y=PM10,
main="Scatter Plot of PM10-PM2.5",
color=Month,
size=5
)
) +
# 用geom_smooth()加上趨勢線
geom_smooth(aes(x=PM2.5,
y=PM10)) +
scale_color_continuous(low = "lightblue",high = "darkblue")+
guides(size=FALSE)+
# 用labs()，進行文字上的標註(Annotation)
labs(title="Scatter of PM10-PM2.5",
x="PM2.5",
y="PM10") + theme_bw()
ggplotly()
ggplot(data=Air_Tidy.s) +
# 散布圖對應的函式是geom_point()
geom_point(aes(x=PM2.5,  # 用aes()，描繪散布圖內的各種屬性
y=PM10,
main="Scatter Plot of PM10-PM2.5",
color=Station,
size=5
)
) +
# 用geom_smooth()加上趨勢線
geom_smooth(aes(x=PM2.5,
y=PM10)) +
scale_color_continuous(low = "lightblue",high = "darkblue")+
guides(size=FALSE)+
# 用labs()，進行文字上的標註(Annotation)
labs(title="Scatter of PM10-PM2.5",
x="PM2.5",
y="PM10") + theme_bw()
ggplot(data=Air_Tidy.s) +
# 散布圖對應的函式是geom_point()
geom_point(aes(x=PM2.5,  # 用aes()，描繪散布圖內的各種屬性
y=PM10,
main="Scatter Plot of PM10-PM2.5",
color=Station,
size=5
)
) +
# 用geom_smooth()加上趨勢線
geom_smooth(aes(x=PM2.5,
y=PM10)) +
scale_color_continuous(low = "lightblue",high = "darkblue")+
guides(size=FALSE)+
# 用labs()，進行文字上的標註(Annotation)
labs(title="Scatter of PM10-PM2.5",
x="PM2.5",
y="PM10") + theme_bw()
ggplot(data=Air_Tidy.s) +
# 散布圖對應的函式是geom_point()
geom_point(aes(x=PM2.5,  # 用aes()，描繪散布圖內的各種屬性
y=PM10,
main="Scatter Plot of PM10-PM2.5",
color=Month,
size=5
)
) +
# 用geom_smooth()加上趨勢線
geom_smooth(aes(x=PM2.5,
y=PM10)) +
scale_color_continuous(low = "lightblue",high = "darkblue")+
guides(size=FALSE)+
# 用labs()，進行文字上的標註(Annotation)
labs(title="Scatter of PM10-PM2.5",
x="PM2.5",
y="PM10") + theme_bw()
ggplot(data=Air_Tidy.s) +
# 散布圖對應的函式是geom_point()
geom_point(aes(x=PM2.5,  # 用aes()，描繪散布圖內的各種屬性
y=PM10,
main="Scatter Plot of PM10-PM2.5",
color=Month,
size=1.5
)
) +
# 用geom_smooth()加上趨勢線
geom_smooth(aes(x=PM2.5,
y=PM10)) +
scale_color_continuous(low = "lightblue",high = "darkblue")+
guides(size=FALSE)+
# 用labs()，進行文字上的標註(Annotation)
labs(title="Scatter of PM10-PM2.5",
x="PM2.5",
y="PM10") + theme_bw()
ggplot(data=Air_Tidy.s) +
# 散布圖對應的函式是geom_point()
geom_point(aes(x=PM2.5,  # 用aes()，描繪散布圖內的各種屬性
y=PM10,
main="Scatter Plot of PM10-PM2.5",
color=Month
)
) +
# 用geom_smooth()加上趨勢線
geom_smooth(aes(x=PM2.5,
y=PM10)) +
scale_color_continuous(low = "lightblue",high = "darkblue")+
guides(size=FALSE)+
# 用labs()，進行文字上的標註(Annotation)
labs(title="Scatter of PM10-PM2.5",
x="PM2.5",
y="PM10") + theme_bw()
ggplot(data=Air_Tidy.s) +
# 散布圖對應的函式是geom_point()
geom_point(aes(x=PM2.5,  # 用aes()，描繪散布圖內的各種屬性
y=PM10,
main="Scatter Plot of PM10-PM2.5",
color=Month
)
) +
# 用geom_smooth()加上趨勢線
geom_smooth(aes(x=PM2.5,
y=PM10)) +
scale_color_continuous(low = "lightblue",high = "darkblue")+
# 用labs()，進行文字上的標註(Annotation)
labs(title="Scatter of PM10-PM2.5",
x="PM2.5",
y="PM10") + theme_bw()
cor(Air_Tidy.s$PM10,Air_Tidy.s$PM2.5)
ggplot(data=Air_Tidy.s) +
# 散布圖對應的函式是geom_point()
geom_point(aes(x=PM2.5,  # 用aes()，描繪散布圖內的各種屬性
y=PM10,
main="Scatter Plot of PM10-PM2.5",
color=Month
)
) +
# 用geom_smooth()加上趨勢線
geom_smooth(aes(x=PM2.5,
y=PM10)) +
scale_color_continuous(low = "lightblue",high = "darkblue")+
# 用labs()，進行文字上的標註(Annotation)
labs(title="Scatter of PM10-PM2.5",
x="PM2.5",
y="PM10") + theme_bw()
AirPollution.201607 <- rbind(
Banqiao[grepl("2016/07",Banqiao$Date),],
Linkou[grepl("2016/07",Linkou$Date),],
Sanchong[grepl("2016/07",Sanchong$Date),],
Tucheng[grepl("2016/07",Tucheng$Date),],
WanLi[grepl("2016/07",WanLi$Date),],
Xinzhuang[grepl("2016/07",Xinzhuang$Date),],
Xizhi[grepl("2016/07",Xizhi$Date),])
AirPollution.201607 <- as.data.frame(AirPollution.201607)
for (i in 4:ncol(AirPollution.201607)) {
if (!all(AirPollution.201607[,i] %in% c(" ","x","*","#"))) {
AirPollution.201607[,i] <- as.numeric(AirPollution.201607[,i])
}
}
AirPollution.201607$Average<- round(rowMeans(AirPollution.201607[, 4:27],na.rm = TRUE),2)
AirPollution.201607 <- AirPollution.201607[order(AirPollution.201607$Item, -AirPollution.201607$Average),]
Air_Tidy.s <- spread(Air_Tidy, Item, Mean)
Air_Tidy.m <- melt(Air_Tidy, id.vars = c("Station","Month","Item"))
Air_Tidy<-rbind(
AirPollution.201608[,-4:-27] %>% group_by(Station,Item) %>%
summarise(
Month= 8,
Mean = mean(Average,na.rm = T)),
AirPollution.201609[,-4:-27] %>% group_by(Station,Item) %>%
summarise(
Month= 9,
Mean = mean(Average,na.rm = T)),
AirPollution.201610[,-4:-27] %>% group_by(Station,Item) %>%
summarise(
Month= 10,
Mean = mean(Average,na.rm = T)),
AirPollution.201611[,-4:-27] %>% group_by(Station,Item) %>%
summarise(
Month= 11,
Mean = mean(Average,na.rm = T)),
AirPollution.201612[,-4:-27] %>% group_by(Station,Item) %>%
summarise(
Month= 12,
Mean = mean(Average,na.rm = T))
)
Air_Tidy.s <- spread(Air_Tidy, Item, Mean)
View(Air_Tidy)
Air_Tidy<-rbind(
AirPollution.201607[,-4:-27] %>% group_by(Station,Item) %>%
summarise(
Month= 7,
Mean = mean(Average,na.rm = T)),
AirPollution.201608[,-4:-27] %>% group_by(Station,Item) %>%
summarise(
Month= 8,
Mean = mean(Average,na.rm = T)),
AirPollution.201609[,-4:-27] %>% group_by(Station,Item) %>%
summarise(
Month= 9,
Mean = mean(Average,na.rm = T)),
AirPollution.201610[,-4:-27] %>% group_by(Station,Item) %>%
summarise(
Month= 10,
Mean = mean(Average,na.rm = T)),
AirPollution.201611[,-4:-27] %>% group_by(Station,Item) %>%
summarise(
Month= 11,
Mean = mean(Average,na.rm = T)),
AirPollution.201612[,-4:-27] %>% group_by(Station,Item) %>%
summarise(
Month= 12,
Mean = mean(Average,na.rm = T))
)
Air_Tidy.s <- spread(Air_Tidy, Item, Mean)
Air_Tidy.m <- melt(Air_Tidy, id.vars = c("Station","Month","Item"))
cor(Air_Tidy.s$PM10,Air_Tidy.s$PM2.5)
ggplot(data=Air_Tidy.s) +
# 散布圖對應的函式是geom_point()
geom_point(aes(x=PM2.5,  # 用aes()，描繪散布圖內的各種屬性
y=PM10,
main="Scatter Plot of PM10-PM2.5",
color=Month
)
) +
# 用geom_smooth()加上趨勢線
geom_smooth(aes(x=PM2.5,
y=PM10)) +
scale_color_continuous(low = "lightblue",high = "darkblue")+
# 用labs()，進行文字上的標註(Annotation)
labs(title="Scatter of PM10-PM2.5",
x="PM2.5",
y="PM10") + theme_bw()
ggplot(data=Air_Tidy.s) +
# 散布圖對應的函式是geom_point()
geom_point(aes(x=PM2.5,  # 用aes()，描繪散布圖內的各種屬性
y=PM10,
main="Scatter Plot of PM10-PM2.5",
color=Month
)
) +
# 用geom_smooth()加上趨勢線
geom_smooth(aes(x=PM2.5,
y=PM10)) +
scale_color_continuous(low = "lightblue",high = "darkblue")+
# 用labs()，進行文字上的標註(Annotation)
labs(title="Scatter of PM10-PM2.5",
x="PM2.5",
y="PM10") + theme_bw()
qplot(Station , data = Air_Tidy.s, geom = "bar", weight = PM2.5/5) +
ylab("PM2.5") + geom_bar(stat = 'count', fill = 'steelblue', colour = 'blue')+ theme_bw()
ggplot(data=Air_Tidy.s) +
# 散布圖對應的函式是geom_point()
geom_point(aes(x=PM2.5,  # 用aes()，描繪散布圖內的各種屬性
y=PM10,
main="Scatter Plot of PM10-PM2.5",
color=Month
)
) +
# 用geom_smooth()加上趨勢線
geom_smooth(aes(x=PM2.5,
y=PM10)) +
scale_color_continuous(low = "lightblue",high = "darkblue")+
# 用labs()，進行文字上的標註(Annotation)
labs(title="Scatter of PM10-PM2.5",
x="PM2.5",
y="PM10") + theme_bw()
qplot(Station , data = Air_Tidy.s, geom = "bar", weight = PM2.5/6) +
ylab("PM2.5") + geom_bar(stat = 'count', fill = 'steelblue', colour = 'blue')+ theme_bw()
cor(Air_Tidy.s$PM10,Air_Tidy.s$PM2.5)
