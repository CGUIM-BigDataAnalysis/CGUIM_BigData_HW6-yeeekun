---
title: "長庚大學 大數據分析方法 作業六"
output: github_document
---


## 作業說明 （繳交時請直接刪除這個章節）

作業目的：期末專題暖身

依下列指示，完成期末分析專題作業規劃：

- 訂出分析問題，並將R Markdown的一級標題(第一行的title:)中的"長庚大學 大數據分析方法 作業六"取代為期末專題的分析問題，並在分析議題背景前加上組員姓名 (`10pt`)
- 分析議題背景 (`10pt`) 與動機 (`10pt`)
- 資料說明 (`10pt`) 與 載入 (`10pt`)
- 資料處理與清洗 (`10pt`) 說明 (`10pt`)
- 對資料們進行探索式資料分析，圖文並茂佳!(`20pt`)
- 期末專題分析規劃與假設 (`10pt`)

## 分析議題背景
PM 就是英文Particulate Matter（顆粒物）的縮寫。

PM10代表空氣中空氣動力學粒徑小於等於10微米的所有顆粒物；
PM2.5代表空氣中空氣動力學粒徑小於等於2.5微米的所有顆粒物；又稱細顆粒，細顆粒進入肺泡。 由此可見，PM10中包含粒徑小於2.5微米的顆粒物，即PM10包含PM2.5。世界衛生組織（WHO）指出： 對於發展中國家的城市：PM10中有近一半是PM2.5；
對於已開發國家城市:PM10中PM2.5占50%至80%。由此，當空氣中PM2.5的濃度數據增加時，PM10的濃度數據就會升高。故目前歐盟國家仍然只監測PM10的濃度數據。

PM10能被人直接吸入呼吸道，但部分可通過痰液等排出體外，也會被鼻腔內部的絨毛阻擋，對人體健康危害相對較小。不過PM10對於能見度和溫度的影響非常明顯。
PM2.5通過呼吸可以到達肺部。這些顆粒物在肺泡上沉積下來，會干擾肺部的氣體交換，損傷肺泡和粘膜，引起肺組織的慢性纖維化，導致肺心病，加重哮喘病，引起慢性鼻咽炎、慢性支氣管炎等一系列病變，這些顆粒物還可以通過支氣管和肺泡進入血液，其中的有害氣體、重金屬等溶解在血液中，嚴重的可危及生命，對兒童和老年人的危害尤為明顯。

## 分析動機
相信大家都對PM10及PM2.5這幾個名詞不陌生了，也知道它對人體健康會有危害，因此我們找出開放資料，就北部幾個區域於2016/12/31這一天的情況來比較看看到底是哪裡的空氣最髒，再來看看工廠在各區的分布多寡和空氣汙染的高低有沒有關聯。

## 使用資料
說明使用資料們

載入使用資料們
```{r}
#這是R Code Chunk
library(readr)
library(readxl)
Banqiao <- read_excel("D:/BigDataHW/HW6/NewTaipeiCity/105年板橋站_20170217.xls")
Linkou <- read_excel("D:/BigDataHW/HW6/NewTaipeiCity/105年林口站_20170217.xls")
Sanchong <- read_excel("D:/BigDataHW/HW6/NewTaipeiCity/105年三重站_20170217.xls")
Tanshui <- read_excel("D:/BigDataHW/HW6/NewTaipeiCity/105年淡水站_20170217.xls")
Tucheng <- read_excel("D:/BigDataHW/HW6/NewTaipeiCity/105年土城站_20170217.xls")
WanLi <- read_excel("D:/BigDataHW/HW6/NewTaipeiCity/105年萬里站_20170217.xls")
Xinzhuang <- read_excel("D:/BigDataHW/HW6/NewTaipeiCity/105年新莊站_20170217.xls")
Xizhi <- read_excel("D:/BigDataHW/HW6/NewTaipeiCity/105年汐止站_20170217.xls")
NewTaipeiFactoryLocation <- read_csv("D:/BigDataHW/HW6/NewTaipeiFactoryLocation_0002336861720153000188.csv")
```

## 資料處理與清洗
說明處理資料的步驟
我們要先清洗出各站2016/12/31的資料，再把他們結合成一張表方便比對，再來將所有的數據charactor轉成num，由於資料表型態原本讀入是‘tbl_df’, ‘tbl’ and 'data.frame'，將字串轉成num時會有是資料是list所以物件無法強制轉成double的問題，因此在這裡先把資料表轉成data.frame再將資料型態轉換，再新增一個欄位求出當日的個數據平均。
    而工廠清洗，我們先洗出還在生產中的工廠，再新增一個欄位Area填入區域，方便後便製圖以及比較，只用group_by和summarise求出每個區域有多少工廠，然後再以工廠數量來排序。
處理資料
```{r}
#這是R Code Chunk
AirPollution.20160231 <- rbind(
  Banqiao[grepl("2016/12/31",Banqiao$`日期`),],
  Linkou[grepl("2016/12/31",Linkou$`日期`),],
  Sanchong[grepl("2016/12/31",Sanchong$`日期`),],
  Tanshui[grepl("2016/12/31",Tanshui$`日期`),],
  Tucheng[grepl("2016/12/31",Tucheng$`日期`),],
  WanLi[grepl("2016/12/31",WanLi$`日期`),],
  Xinzhuang[grepl("2016/12/31",Xinzhuang$`日期`),],
  Xizhi[grepl("2016/12/31",Xizhi$`日期`),])

AirPollution.20160231 <- as.data.frame(AirPollution.20160231) 
for (i in 4:ncol(AirPollution.20160231)) {
   if (!all(AirPollution.20160231[,i] %in% c("NR"," ","x","*","#"))) {
     AirPollution.20160231[,i] <- as.numeric(AirPollution.20160231[,i])
   }
}
AirPollution.20160231$Average<- round(rowMeans(AirPollution.20160231[, 4:27],na.rm = TRUE),2)
AirPollution.20160231 <- AirPollution.20160231[order(AirPollution.20160231$`測項`, -AirPollution.20160231$Average),]

##工廠清洗
factory_operate <- NewTaipeiFactoryLocation[grepl("生產中",NewTaipeiFactoryLocation$STATUS),]
factory_operate$Area <- substr(factory_operate$FACT_ADDR,4,6)
#找出各區工廠數量，再以數量排序
library(dplyr)
factory_Area_Qunality <- group_by(factory_operate,Area)%>%summarise(nQuantity=n_distinct(FACT_NAME))
factory_Area_Qunality <- arrange(factory_Area_Qunality,desc(nQuantity))

```

## 探索式資料分析
圖文並茂圖文並茂
```{r}
#這是R Code Chunk
```

## 期末專題分析規劃
期末專題要做XXOOO交叉分析
